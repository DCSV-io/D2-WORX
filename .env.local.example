# D2-WORX Environment Variables
# Copy this file to .env.local and fill in your values.
# WARNING: Never commit .env.local to version control.
#
# Convention: SECTION_PROPERTY (single underscore = hierarchy separator).
# D2Env auto-maps these to .NET configuration paths for both local and production use.

# ===========================================
# Infrastructure (Aspire Parameters)
# ===========================================
DB_USERNAME=postgres
DB_PASSWORD=your_secure_password_here
DBA_EMAIL=admin@example.com
DBA_PASSWORD=your_secure_password_here
MQ_USERNAME=rabbitmq
MQ_PASSWORD=your_secure_password_here
CACHE_PASSWORD=your_secure_password_here
S3_USERNAME=minio
S3_PASSWORD=your_secure_password_here
OTEL_USERNAME=admin
OTEL_PASSWORD=your_secure_password_here

# ===========================================
# Geo Service Options
# ===========================================
# IPInfo API token for WhoIs/geolocation lookups
# Get a free token at https://ipinfo.io/signup
GEOINFRAOPTIONS_IPINFOACCESSTOKEN=your_ipinfo_token_here

# ===========================================
# Geo API — API Key Mappings (server-side)
# ===========================================
# Maps API keys to allowed context keys for contact operations.
# Format: GEOAPPOPTIONS_APIKEYMAPPINGS__<api-key>__<index>=<context-key>
# Auth — org contacts + user contacts
GEOAPPOPTIONS_APIKEYMAPPINGS__your_auth_api_key_here__0=org_contact
GEOAPPOPTIONS_APIKEYMAPPINGS__your_auth_api_key_here__1=user
# Comms — needs all contact types for recipient resolution
GEOAPPOPTIONS_APIKEYMAPPINGS__your_comms_api_key_here__0=org_contact
GEOAPPOPTIONS_APIKEYMAPPINGS__your_comms_api_key_here__1=user

# ===========================================
# Geo Service — gRPC Address (for Node.js consumers)
# ===========================================
# The Geo .NET service gRPC endpoint (HTTP/2). Used by auth + comms Node services.
GEO_GRPC_ADDRESS=localhost:5138

# ===========================================
# Geo Client Options — Shared Defaults
# ===========================================
# All Geo client consumers inherit these. Override per-service with {Prefix}GeoClientOptions.
# GEOCLIENTOPTIONS_WHOISCACHEMAXENTRIES=10000

# ===========================================
# Geo Client Options — Auth Service Overrides
# ===========================================
# Prefix: "Auth" → section: AuthGeoClientOptions
# API key for authenticating to Geo service contact operations (must match a key above)
AUTHGEOCLIENTOPTIONS_APIKEY=your_api_key_here
# Allowed context keys (client-side defense-in-depth, must match server mapping)
AUTHGEOCLIENTOPTIONS_ALLOWEDCONTEXTKEYS__0=org_contact
AUTHGEOCLIENTOPTIONS_ALLOWEDCONTEXTKEYS__1=user

# ===========================================
# Geo Client Options — Comms Service Overrides
# ===========================================
# Prefix: "Comms" → section: CommsGeoClientOptions
# API key for authenticating to Geo service contact operations (must match a key above)
COMMSGEOCLIENTOPTIONS_APIKEY=your_api_key_here
# Allowed context keys (all contact types — comms resolves recipients across all contexts)
COMMSGEOCLIENTOPTIONS_ALLOWEDCONTEXTKEYS__0=org_contact
COMMSGEOCLIENTOPTIONS_ALLOWEDCONTEXTKEYS__1=user

# ===========================================
# Auth Service (Node.js / Hono + BetterAuth)
# ===========================================
# Database URL is injected by Aspire (ConnectionStrings__d2-services-auth).
# Redis + RabbitMQ URLs also injected via Aspire refs.
AUTH_BASE_URL=http://localhost:3100
AUTH_CORS_ORIGIN=http://localhost:5173
AUTH_JWT_ISSUER=d2-worx
AUTH_JWT_AUDIENCE=d2-services

# ===========================================
# Comms Service (Node.js / headless consumer + gRPC)
# ===========================================
# Database URL is injected by Aspire (ConnectionStrings__d2-services-comms).
# RabbitMQ URL also injected via Aspire refs.
# API keys for callers authenticating to the Comms gRPC service
# Format: COMMS_API_KEYS__<index>=<key>
# Auth service key
COMMS_API_KEYS__0=your_auth_comms_api_key_here
# REST gateway key (future)
COMMS_API_KEYS__1=your_gateway_comms_api_key_here
GRPC_PORT=5200

# Resend — Email provider
# Sign up for a free API key at https://resend.com/signup (100 emails/day free)
# For dev/testing, use the built-in test domain: onboarding@resend.dev
RESEND_API_KEY=re_your_api_key_here
RESEND_FROM_ADDRESS=onboarding@resend.dev

# Twilio — SMS provider (optional, SMS is a fallback channel)
# Sign up for a free trial at https://www.twilio.com/try-twilio ($15 credit)
# Get Account SID + Auth Token from https://console.twilio.com
# Buy a phone number from the console (costs ~$1.15/mo from trial credit)
TWILIO_ACCOUNT_SID=AC_your_account_sid_here
TWILIO_AUTH_TOKEN=your_auth_token_here
TWILIO_PHONE_NUMBER=+1your_twilio_number_here

# ===========================================
# REST Gateway — Service-to-Service API Keys
# ===========================================
# Valid API keys for backend callers (SvelteKit, etc.) hitting service-only REST endpoints.
# Format: SERVICEKEYOPTIONS_VALIDKEYS__<index>=<key>
SERVICEKEYOPTIONS_VALIDKEYS__0=your_service_key_here

# ===========================================
# SvelteKit / Web Client
# ===========================================
PUBLIC_API_URL=http://localhost:5000
